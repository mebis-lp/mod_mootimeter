define("mootimetertool_quiz/chart_draw",["exports","mootimetertool_quiz/chart.umd","core/ajax"],(function(_exports,_chart,_ajax){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_chart=(obj=_chart)&&obj.__esModule?obj:{default:obj};_exports.init=id=>{if(!document.getElementById(id))return;const pageid=document.getElementById(id).dataset.pageid;getAnswers(pageid,id),setTimeout((()=>{const intervalms=document.getElementById("mootimeterstate").dataset.refreshinterval,interval=setInterval((()=>{document.getElementById(id)?getAnswers(pageid,id):clearInterval(interval)}),intervalms)}),5e3)};const getAnswers=async(pageid,id)=>{const mtmstate=document.getElementById("mootimeterstate");if(mtmstate.dataset.lastupdated==mtmstate.dataset.contentchangedat)return;const response=await(pageid=>(0,_ajax.call)([{methodname:"mootimetertool_quiz_get_answers",args:{pageid:pageid}}])[0])(pageid);if(!document.getElementById(id))return;document.getElementById("mootimeterstate").setAttribute("data-lastupdated",response.lastupdated);let nodecanvas=document.getElementById(id);nodecanvas.setAttribute("data-labels",response.labels),nodecanvas.setAttribute("data-values",response.values),nodecanvas.setAttribute("data-chartsettings",response.chartsettings);var config={type:JSON.parse(response.chartsettings).charttype,data:{labels:JSON.parse(response.labels),datasets:[{label:response.question,data:JSON.parse(response.values),backgroundColor:JSON.parse(response.chartsettings).backgroundColor,borderRadius:JSON.parse(response.chartsettings).borderRadius,pointStyle:JSON.parse(response.chartsettings).pointStyle,pointRadius:JSON.parse(response.chartsettings).pointRadius,pointHoverRadius:JSON.parse(response.chartsettings).pointHoverRadius}]},options:JSON.parse(response.chartsettings).options};let chartStatus=_chart.default.getChart(id);null!=chartStatus&&chartStatus.destroy(),new _chart.default(document.getElementById(id),config),_chart.default.defaults.font.size=25,_chart.default.defaults.stepSize=1}}));

//# sourceMappingURL=chart_draw.min.js.map