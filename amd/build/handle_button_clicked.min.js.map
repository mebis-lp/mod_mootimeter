{"version":3,"file":"handle_button_clicked.min.js","sources":["../src/handle_button_clicked.js"],"sourcesContent":["import {call as fetchMany} from 'core/ajax';\nimport Log from 'core/log';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport {get_string as getString} from 'core/str';\nimport {execReloadPage as reloadPage} from 'mod_mootimeter/reload_page';\n\nexport const init = async(uniqueID) => {\n    var obj = document.getElementById(uniqueID);\n\n    if (!document.getElementById(uniqueID)) {\n        return;\n    }\n\n    obj.addEventListener(\"click\", buttonClicked);\n\n    var dataset = obj.dataset;\n    var confirmationTitleStr;\n    if (!obj.getAttribute(\"data-confirmationtitlestr\")) {\n        confirmationTitleStr = getString('delete', 'core');\n    } else {\n        confirmationTitleStr = dataset.confirmationtitlestr;\n    }\n\n    var confirmationQuestionStr;\n    if (!obj.getAttribute(\"data-confirmationquestionstr\")) {\n        confirmationQuestionStr = getString('areyousure');\n    } else {\n        confirmationQuestionStr = dataset.confirmationquestionstr;\n    }\n\n    var confirmationType;\n    if (!obj.getAttribute(\"data-confirmationtype\")) {\n        confirmationType = ModalFactory.types.DELETE_CANCEL;\n    } else {\n        switch (dataset.confirmationtype) {\n            case 'DELETE_CANCEL':\n                confirmationType = ModalFactory.types.DELETE_CANCEL;\n                break;\n        }\n    }\n\n    const modal = await ModalFactory.create({\n        type: confirmationType,\n        title: confirmationTitleStr,\n        body: confirmationQuestionStr,\n        pageid: 5,\n    });\n\n    modal.getRoot().on(ModalEvents.delete, function() {\n        var pageid = obj.dataset.pageid;\n        var uniqueID = obj.id;\n        var ajaxmethode = obj.dataset.ajaxmethode;\n\n        buttonClickedHandle(pageid, uniqueID, ajaxmethode);\n    });\n\n    /**\n     * Store the value.\n     */\n    function buttonClicked() {\n        modal.show();\n    }\n};\n\n/**\n * Call to store input value\n * @param {int} pageid\n * @param {string} thisDataset\n * @param {string} ajaxmethode\n * @returns {mixed}\n */\nconst execButtonClicked = (\n    pageid,\n    thisDataset,\n    ajaxmethode\n) => fetchMany([{\n    methodname: ajaxmethode,\n    args: {\n        pageid,\n        thisDataset\n    },\n}])[0];\n\n/**\n * Executes the call to store input value.\n * @param {int} pageid\n * @param {string} uniqueID\n * @param {string} ajaxmethode\n */\nconst buttonClickedHandle = async(pageid, uniqueID, ajaxmethode) => {\n    var dataset = JSON.stringify(document.getElementById(uniqueID).dataset);\n    const response = await execButtonClicked(pageid, dataset, ajaxmethode);\n\n    if (response.code != 200) {\n        Log.error(response.string);\n    }\n\n    if (response.reload == true) {\n        const queryString = window.location.search;\n        const urlParams = new URLSearchParams(queryString);\n        reloadPage(urlParams.get('pageid'), urlParams.get('id'));\n    }\n};"],"names":["async","obj","document","getElementById","uniqueID","addEventListener","modal","show","confirmationTitleStr","confirmationQuestionStr","confirmationType","dataset","getAttribute","confirmationtitlestr","confirmationquestionstr","confirmationtype","ModalFactory","types","DELETE_CANCEL","create","type","title","body","pageid","getRoot","on","ModalEvents","delete","id","ajaxmethode","buttonClickedHandle","JSON","stringify","response","thisDataset","methodname","args","execButtonClicked","code","error","string","reload","queryString","window","location","search","urlParams","URLSearchParams","get"],"mappings":"yiBAOoBA,MAAAA,eACZC,IAAMC,SAASC,eAAeC,cAE7BF,SAASC,eAAeC,iBAI7BH,IAAII,iBAAiB,oBA+CjBC,MAAMC,cA5CNC,qBAOAC,wBAOAC,iBAfAC,QAAUV,IAAIU,WAKdH,qBAHCP,IAAIW,aAAa,6BAGKD,QAAQE,sBAFR,mBAAU,SAAU,QAS3CJ,wBAHCR,IAAIW,aAAa,gCAGQD,QAAQG,yBAFR,mBAAU,cAMnCb,IAAIW,aAAa,6BAIT,kBADDD,QAAQI,iBAERL,iBAAmBM,uBAAaC,MAAMC,mBAJ9CR,iBAAmBM,uBAAaC,MAAMC,oBASpCZ,YAAcU,uBAAaG,OAAO,CACpCC,KAAMV,iBACNW,MAAOb,qBACPc,KAAMb,wBACNc,OAAQ,IAGZjB,MAAMkB,UAAUC,GAAGC,sBAAYC,QAAQ,eAC/BJ,OAAStB,IAAIU,QAAQY,OACrBnB,SAAWH,IAAI2B,GACfC,YAAc5B,IAAIU,QAAQkB,YAE9BC,oBAAoBP,OAAQnB,SAAUyB,uBAoCxCC,oBAAsB9B,MAAMuB,OAAQnB,SAAUyB,mBAC5ClB,QAAUoB,KAAKC,UAAU9B,SAASC,eAAeC,UAAUO,eACzDsB,cApBgB,EACtBV,OACAW,YACAL,eACC,cAAU,CAAC,CACZM,WAAYN,YACZO,KAAM,CACFb,OAAAA,OACAW,YAAAA,gBAEJ,GAUuBG,CAAkBd,OAAQZ,QAASkB,gBAErC,KAAjBI,SAASK,mBACLC,MAAMN,SAASO,QAGA,GAAnBP,SAASQ,OAAgB,OACnBC,YAAcC,OAAOC,SAASC,OAC9BC,UAAY,IAAIC,gBAAgBL,6CAC3BI,UAAUE,IAAI,UAAWF,UAAUE,IAAI"}