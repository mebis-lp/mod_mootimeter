define("mod_mootimeter/reload_page",["exports","core/ajax","core/log","core/notification","core/templates","mod_mootimeter/reload_pagelist","mod_mootimeter/utils"],(function(_exports,_ajax,_log,_notification,_templates,_reload_pagelist,_utils){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.execReloadPage=void 0,_log=_interopRequireDefault(_log),_templates=_interopRequireDefault(_templates);_exports.init=uniqueID=>{const obj=document.getElementById(uniqueID);obj&&obj.addEventListener("click",(function(){var pageid=0,dataset="";this.dataset&&(pageid=this.dataset.pageid,dataset=this.dataset);null!=pageid&&"undefined"!=pageid&&0!=pageid.length||(pageid=0);const queryString=window.location.search,cmid=new URLSearchParams(queryString).get("id");execReloadPage(pageid,cmid,dataset)}))};const execReloadPage=async(pageid,cmid,dataset)=>{dataset?Object.assign(dataset,(0,_utils.getGetParams)()):dataset=(0,_utils.getGetParams)(),dataset=JSON.stringify(dataset);const response=await((pageid,cmid,dataset)=>(0,_ajax.call)([{methodname:"mod_mootimeter_get_pagecontentparams",args:{pageid:pageid,cmid:cmid,dataset:dataset}}])[0])(pageid,cmid,dataset);if(200!=response.code&&_log.default.error(response.string),200==response.code){var mtmstate=document.getElementById("mootimeterstate");const pageparmas=JSON.parse(response.pageparams);if(_templates.default.renderForPromise(pageparmas.pagecontent.template,pageparmas.pagecontent).then((_ref=>{let{html:html,js:js}=_ref;return _templates.default.replaceNodeContents("#mootimeter-pagecontent",html,js),!0})).catch((error=>(0,_notification.exception)(error))),pageparmas.contentmenu&&(_templates.default.renderForPromise(pageparmas.contentmenu.template,pageparmas.contentmenu).then((_ref2=>{let{html:html,js:js}=_ref2;return _templates.default.replaceNode("#mootimeter-pagecontentmenu",html,js),!0})).catch((error=>(0,_notification.exception)(error))),pageparmas.contentmenu.sp)){var container=document.querySelector(".mootimetercontainer");for(const[key,value]of Object.entries(pageparmas.contentmenu.sp))(0,_utils.setGetParam)(key,value),setFullscreenClass(container,key,value)}pageparmas.colsettings&&_templates.default.renderForPromise(pageparmas.colsettings.template,pageparmas.colsettings).then((_ref3=>{let{html:html,js:js}=_ref3;return _templates.default.replaceNodeContents("#mootimeter-col-settings",html,js),!0})).catch((error=>(0,_notification.exception)(error))),pageparmas.pageid&&(mtmstate.setAttribute("data-pageid",pageparmas.pageid),(0,_utils.setGetParam)("pageid",pageparmas.pageid)),(0,_reload_pagelist.execReloadPagelist)(pageid,cmid,!0),document.querySelectorAll(".tooltip").forEach((e=>e.remove()))}};function setFullscreenClass(container,key,value){var elem;"f"==key&&1==value?(container.classList.add("fullscreen"),document.getElementById("page-wrapper").classList.add("fullscreen"),(elem=document.getElementById("page-wrapper")).requestFullscreen?elem.requestFullscreen():elem.webkitRequestFullscreen&&elem.webkitRequestFullscreen()):"f"==key&&0==value&&null!==document.fullscreenElement&&(container.classList.remove("fullscreen"),document.getElementById("page-wrapper").classList.remove("fullscreen"),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}_exports.execReloadPage=execReloadPage}));

//# sourceMappingURL=reload_page.min.js.map